# =============================================================================
# Scandium - Production-Grade Precision Landing System
# pytest Test Framework Configuration
# =============================================================================
# pytest is the Python testing framework.
# Reference: https://docs.pytest.org/en/stable/reference/customize.html
# =============================================================================

# -----------------------------------------------------------------------------
# Core Configuration
# -----------------------------------------------------------------------------

[pytest]
# Minimum pytest version required
minversion = 8.0

# Test discovery paths
testpaths =
    tests

# Python file patterns for test discovery
python_files =
    test_*.py
    *_test.py

# Python class patterns for test discovery
python_classes =
    Test*
    *Tests

# Python function patterns for test discovery
python_functions =
    test_*

# -----------------------------------------------------------------------------
# Command Line Options
# -----------------------------------------------------------------------------

# Default command line options
addopts =
    --verbose
    --tb=short
    --strict-markers
    --strict-config
    --durations=10
    --durations-min=1.0
    -ra

# -----------------------------------------------------------------------------
# Markers
# -----------------------------------------------------------------------------

# Custom markers (must be registered for --strict-markers)
markers =
    unit: Unit tests (isolated, fast, no external dependencies)
    integration: Integration tests (may require external services)
    slow: Slow tests (execution time > 1 second)
    simulation: Tests requiring simulation environment (AirSim/SITL)
    hardware: Tests requiring physical hardware (camera, MAVLink device)
    smoke: Smoke tests (minimal subset for quick validation)

# -----------------------------------------------------------------------------
# Warning Configuration
# -----------------------------------------------------------------------------

# Warning filters
filterwarnings =
    error
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    ignore::pytest.PytestUnraisableExceptionWarning
    ignore:.*pkg_resources.*:DeprecationWarning

# -----------------------------------------------------------------------------
# Logging Configuration
# -----------------------------------------------------------------------------

# Log CLI output
log_cli = false

# Log CLI log level
log_cli_level = INFO

# Log CLI format
log_cli_format = %(asctime)s [%(levelname)8s] %(name)s: %(message)s

# Log CLI date format
log_cli_date_format = %Y-%m-%d %H:%M:%S

# Log file
log_file = tests/test_output.log

# Log file level
log_file_level = DEBUG

# Log file format
log_file_format = %(asctime)s [%(levelname)8s] %(name)s (%(filename)s:%(lineno)d): %(message)s

# Log file date format
log_file_date_format = %Y-%m-%d %H:%M:%S

# -----------------------------------------------------------------------------
# Collection Configuration
# -----------------------------------------------------------------------------

# Patterns to ignore during collection
norecursedirs =
    .git
    .github
    .mypy_cache
    .pytest_cache
    .ruff_cache
    .tox
    .venv
    __pycache__
    build
    dist
    site
    *.egg-info
    node_modules

# Files to ignore during collection
collect_ignore =
    setup.py

# -----------------------------------------------------------------------------
# Assertion Configuration
# -----------------------------------------------------------------------------

# Enable assertion rewriting for test modules
enable_assertion_pass_hook = true

# -----------------------------------------------------------------------------
# Timeout Configuration (requires pytest-timeout plugin)
# -----------------------------------------------------------------------------

# Default test timeout in seconds (0 = disabled)
timeout = 30

# Timeout method
timeout_method = thread

# -----------------------------------------------------------------------------
# Async Configuration (requires pytest-asyncio plugin)
# -----------------------------------------------------------------------------

# Async mode
asyncio_mode = auto

# -----------------------------------------------------------------------------
# Coverage Configuration (requires pytest-cov plugin)
# -----------------------------------------------------------------------------

# Note: Coverage settings are in pyproject.toml under [tool.coverage]
